# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Unprotected initializer](#h-1-unprotected-initializer)
  - [H-2: Unsafe Casting](#h-2-unsafe-casting)
  - [H-3: Storage Array Edited with Memory](#h-3-storage-array-edited-with-memory)
  - [H-4: Functions send eth away from contract but performs no checks on any address.](#h-4-functions-send-eth-away-from-contract-but-performs-no-checks-on-any-address)
  - [H-5: Return value of the function call is not checked.](#h-5-return-value-of-the-function-call-is-not-checked)
  - [H-6: Dangerous strict equality checks on contract balances.](#h-6-dangerous-strict-equality-checks-on-contract-balances)
  - [H-7: Loop contains `msg.value`.](#h-7-loop-contains-msgvalue)
- [Low Issues](#low-issues)
  - [L-1: Unsafe ERC20 Operations should not be used](#l-1-unsafe-erc20-operations-should-not-be-used)
  - [L-2: Solidity pragma should be specific, not wide](#l-2-solidity-pragma-should-be-specific-not-wide)
  - [L-3: Missing checks for `address(0)` when assigning values to address state variables](#l-3-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-4: `public` functions not used internally could be marked `external`](#l-4-public-functions-not-used-internally-could-be-marked-external)
  - [L-5: Define and use `constant` variables instead of using literals](#l-5-define-and-use-constant-variables-instead-of-using-literals)
  - [L-6: Event is missing `indexed` fields](#l-6-event-is-missing-indexed-fields)
  - [L-7: The `nonReentrant` `modifier` should occur before all other modifiers](#l-7-the-nonreentrant-modifier-should-occur-before-all-other-modifiers)
  - [L-8: PUSH0 is not supported by all chains](#l-8-push0-is-not-supported-by-all-chains)
  - [L-9: Modifiers invoked only once can be shoe-horned into the function](#l-9-modifiers-invoked-only-once-can-be-shoe-horned-into-the-function)
  - [L-10: Empty Block](#l-10-empty-block)
  - [L-11: Large literal values multiples of 10000 can be replaced with scientific notation](#l-11-large-literal-values-multiples-of-10000-can-be-replaced-with-scientific-notation)
  - [L-12: Internal functions called only once can be inlined](#l-12-internal-functions-called-only-once-can-be-inlined)
  - [L-13: Unused Custom Error](#l-13-unused-custom-error)
  - [L-14: Loop contains `require`/`revert` statements](#l-14-loop-contains-requirerevert-statements)
  - [L-15: Potentially unused `private` / `internal` state variables found.](#l-15-potentially-unused-private--internal-state-variables-found)
  - [L-16: Uninitialized local variables.](#l-16-uninitialized-local-variables)
  - [L-17: Dead Code](#l-17-dead-code)
  - [L-18: Loop condition contains `state_variable.length` that could be cached outside.](#l-18-loop-condition-contains-statevariablelength-that-could-be-cached-outside)
  - [L-19: Costly operations inside loops.](#l-19-costly-operations-inside-loops)
  - [L-20: Unused Imports](#l-20-unused-imports)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 35 |
| Total nSLOC | 4473 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/System.sol | 81 |
| src/SystemReward.sol | 72 |
| src/access/Protectable.sol | 48 |
| src/block/Block.sol | 56 |
| src/epoch/EpochManager.sol | 90 |
| src/genesis/Genesis.sol | 65 |
| src/governance/GovHub.sol | 35 |
| src/governance/GovToken.sol | 86 |
| src/governance/GravityGovernor.sol | 257 |
| src/governance/Timelock.sol | 25 |
| src/interfaces/IBlock.sol | 20 |
| src/interfaces/IDelegation.sol | 41 |
| src/interfaces/IEpochManager.sol | 24 |
| src/interfaces/IGovToken.sol | 34 |
| src/interfaces/IGroth16Verifier.sol | 10 |
| src/interfaces/IJWKManager.sol | 121 |
| src/interfaces/IKeylessAccount.sol | 67 |
| src/interfaces/IParamSubscriber.sol | 4 |
| src/interfaces/IReconfigurableModule.sol | 4 |
| src/interfaces/IStakeConfig.sol | 63 |
| src/interfaces/IStakeCredit.sol | 106 |
| src/interfaces/ISystemReward.sol | 4 |
| src/interfaces/ITimestamp.sol | 16 |
| src/interfaces/IValidatorManager.sol | 158 |
| src/interfaces/IValidatorPerformanceTracker.sol | 66 |
| src/jwk/Groth16Verifier.sol | 302 |
| src/jwk/JWKManager.sol | 431 |
| src/jwk/JWKUtils.sol | 222 |
| src/jwk/KeylessAccount.sol | 220 |
| src/stake/Delegation.sol | 136 |
| src/stake/StakeConfig.sol | 195 |
| src/stake/StakeCredit.sol | 339 |
| src/stake/ValidatorManager.sol | 799 |
| src/stake/ValidatorPerformanceTracker.sol | 230 |
| src/timestamp/Timestamp.sol | 46 |
| **Total** | **4473** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 7 |
| Low | 20 |


# High Issues

## H-1: Unprotected initializer

Consider protecting the initializer functions with modifiers.

<details><summary>18 Found Instances</summary>


- Found in src/genesis/Genesis.sol [Line: 71](../src/genesis/Genesis.sol#L71)

	```solidity
	    function _initializeStake(
	```

- Found in src/genesis/Genesis.sol [Line: 93](../src/genesis/Genesis.sol#L93)

	```solidity
	    function _initializeEpoch() internal {
	```

- Found in src/genesis/Genesis.sol [Line: 101](../src/genesis/Genesis.sol#L101)

	```solidity
	    function _initializeGovernance() internal {
	```

- Found in src/genesis/Genesis.sol [Line: 115](../src/genesis/Genesis.sol#L115)

	```solidity
	    function _initializeJWK() internal {
	```

- Found in src/interfaces/IBlock.sol [Line: 31](../src/interfaces/IBlock.sol#L31)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IEpochManager.sol [Line: 43](../src/interfaces/IEpochManager.sol#L43)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IGovToken.sol [Line: 39](../src/interfaces/IGovToken.sol#L39)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IJWKManager.sol [Line: 99](../src/interfaces/IJWKManager.sol#L99)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 72](../src/interfaces/IKeylessAccount.sol#L72)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IStakeConfig.sol [Line: 135](../src/interfaces/IStakeConfig.sol#L135)

	```solidity
	    function initialize() external;
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 56](../src/interfaces/IStakeCredit.sol#L56)

	```solidity
	    function initialize(address _validator, string memory _moniker, address _beneficiary) external payable;
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 131](../src/interfaces/IValidatorManager.sol#L131)

	```solidity
	    function initialize(
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 47](../src/interfaces/IValidatorPerformanceTracker.sol#L47)

	```solidity
	    function initialize(
	```

- Found in src/stake/StakeCredit.sol [Line: 84](../src/stake/StakeCredit.sol#L84)

	```solidity
	    function _initializeERC20(
	```

- Found in src/stake/StakeCredit.sol [Line: 96](../src/stake/StakeCredit.sol#L96)

	```solidity
	    function _initializeStakeStates() private {
	```

- Found in src/stake/StakeCredit.sol [Line: 106](../src/stake/StakeCredit.sol#L106)

	```solidity
	    function _bootstrapInitialStake(
	```

- Found in src/stake/StakeCredit.sol [Line: 115](../src/stake/StakeCredit.sol#L115)

	```solidity
	    function _bootstrapInitialHolder(
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 253](../src/stake/ValidatorPerformanceTracker.sol#L253)

	```solidity
	    function _initializeValidatorSet(
	```

</details>



## H-2: Unsafe Casting

Downcasting int/uints in Solidity can be unsafe due to the potential for data loss and unintended behavior.When downcasting a larger integer type to a smaller one (e.g., uint256 to uint128), the value may exceed the range of the target type,leading to truncation and loss of significant digits. Use OpenZeppelin's SafeCast library to safely downcast integers.

<details><summary>1 Found Instances</summary>


- Found in src/block/Block.sol [Line: 41](../src/block/Block.sol#L41)

	```solidity
	        ITimestamp(TIMESTAMP_ADDR).updateGlobalTime(proposer, uint64(timestampMicros));
	```

</details>



## H-3: Storage Array Edited with Memory

Storage reference is passed to a function with a memory parameter. This will not update the storage variable as expected. Consider using storage parameters instead.

<details><summary>6 Found Instances</summary>


- Found in src/jwk/JWKManager.sol [Line: 352](../src/jwk/JWKManager.sol#L352)

	```solidity
	            _applyPatch(patchedJWKs, patches[i]);
	```

- Found in src/jwk/JWKManager.sol [Line: 422](../src/jwk/JWKManager.sol#L422)

	```solidity
	            if (_compareStrings(providerJWKs.issuer, jwks.entries[i].issuer) < 0) {
	```

- Found in src/jwk/JWKManager.sol [Line: 498](../src/jwk/JWKManager.sol#L498)

	```solidity
	                if (keccak256(_getJWKId(provider.jwks[i])) == keccak256(jwkId)) {
	```

- Found in src/jwk/JWKManager.sol [Line: 510](../src/jwk/JWKManager.sol#L510)

	```solidity
	                    bytes memory existingId = _getJWKId(provider.jwks[i]);
	```

- Found in src/jwk/JWKManager.sol [Line: 542](../src/jwk/JWKManager.sol#L542)

	```solidity
	                    if (keccak256(_getJWKId(provider.jwks[j])) == keccak256(jwkId)) {
	```

- Found in src/jwk/JWKManager.sol [Line: 568](../src/jwk/JWKManager.sol#L568)

	```solidity
	                    if (keccak256(_getJWKId(provider.jwks[j])) == keccak256(jwkId)) {
	```

</details>



## H-4: Functions send eth away from contract but performs no checks on any address.

Consider introducing checks for `msg.sender` to ensure the recipient of the money is as intended.

<details><summary>1 Found Instances</summary>


- Found in src/SystemReward.sol [Line: 42](../src/SystemReward.sol#L42)

	```solidity
	    function claimRewards(
	```

</details>



## H-5: Return value of the function call is not checked.

Function returns a value but it is ignored.

<details><summary>1 Found Instances</summary>


- Found in src/governance/GovHub.sol [Line: 22](../src/governance/GovHub.sol#L22)

	```solidity
	        notifyUpdates(proposal);
	```

</details>



## H-6: Dangerous strict equality checks on contract balances.

A contract's balance can be forcibly manipulated by another selfdestructing contract. Therefore, it's recommended to use >, <, >= or <= instead of strict equality.

<details><summary>1 Found Instances</summary>


- Found in src/stake/StakeCredit.sol [Line: 468](../src/stake/StakeCredit.sol#L468)

	```solidity
	        return totalStates == address(this).balance;
	```

</details>



## H-7: Loop contains `msg.value`.

Provide an explicit array of amounts alongside the receivers array, and check that the sum of all amounts matches `msg.value`.

<details><summary>1 Found Instances</summary>


- Found in src/stake/ValidatorManager.sol [Line: 1039](../src/stake/ValidatorManager.sol#L1039)

	```solidity
	            for (uint256 i = 0; i < validators.length; i++) {
	```

</details>



# Low Issues

## L-1: Unsafe ERC20 Operations should not be used

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>1 Found Instances</summary>


- Found in src/SystemReward.sol [Line: 51](../src/SystemReward.sol#L51)

	```solidity
	            to.transfer(actualAmount);
	```

</details>



## L-2: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>3 Found Instances</summary>


- Found in src/interfaces/IGovToken.sol [Line: 2](../src/interfaces/IGovToken.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 2](../src/interfaces/IGroth16Verifier.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 3](../src/jwk/Groth16Verifier.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-3: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

<details><summary>3 Found Instances</summary>


- Found in src/stake/StakeCredit.sol [Line: 67](../src/stake/StakeCredit.sol#L67)

	```solidity
	        validator = _validator;
	```

- Found in src/stake/StakeCredit.sol [Line: 76](../src/stake/StakeCredit.sol#L76)

	```solidity
	        commissionBeneficiary = _beneficiary;
	```

- Found in src/stake/StakeCredit.sol [Line: 508](../src/stake/StakeCredit.sol#L508)

	```solidity
	        commissionBeneficiary = newBeneficiary;
	```

</details>



## L-4: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

<details><summary>24 Found Instances</summary>


- Found in src/governance/GovToken.sol [Line: 31](../src/governance/GovToken.sol#L31)

	```solidity
	    function initialize() public initializer onlyGenesis {
	```

- Found in src/governance/GovToken.sol [Line: 69](../src/governance/GovToken.sol#L69)

	```solidity
	    function totalSupply() public view override(ERC20Upgradeable, IGovToken) returns (uint256) {
	```

- Found in src/governance/GovToken.sol [Line: 76](../src/governance/GovToken.sol#L76)

	```solidity
	    function burn(
	```

- Found in src/governance/GovToken.sol [Line: 85](../src/governance/GovToken.sol#L85)

	```solidity
	    function burnFrom(address, uint256) public pure override(ERC20BurnableUpgradeable, IGovToken) {
	```

- Found in src/governance/GovToken.sol [Line: 143](../src/governance/GovToken.sol#L143)

	```solidity
	    function nonces(
	```

- Found in src/governance/GravityGovernor.sol [Line: 85](../src/governance/GravityGovernor.sol#L85)

	```solidity
	    function propose(
	```

- Found in src/governance/GravityGovernor.sol [Line: 118](../src/governance/GravityGovernor.sol#L118)

	```solidity
	    function queue(
	```

- Found in src/governance/GravityGovernor.sol [Line: 169](../src/governance/GravityGovernor.sol#L169)

	```solidity
	    function supportsInterface(
	```

- Found in src/governance/GravityGovernor.sol [Line: 188](../src/governance/GravityGovernor.sol#L188)

	```solidity
	    function proposalThreshold()
	```

- Found in src/governance/GravityGovernor.sol [Line: 202](../src/governance/GravityGovernor.sol#L202)

	```solidity
	    function proposalDeadline(
	```

- Found in src/governance/GravityGovernor.sol [Line: 291](../src/governance/GravityGovernor.sol#L291)

	```solidity
	    function proposalNeedsQueuing(
	```

- Found in src/governance/GravityGovernor.sol [Line: 362](../src/governance/GravityGovernor.sol#L362)

	```solidity
	    function hasVoted(uint256 proposalId, address account) public view returns (bool) {
	```

- Found in src/governance/GravityGovernor.sol [Line: 369](../src/governance/GravityGovernor.sol#L369)

	```solidity
	    function proposalVotes(
	```

- Found in src/governance/GravityGovernor.sol [Line: 381](../src/governance/GravityGovernor.sol#L381)

	```solidity
	    function COUNTING_MODE() public pure override returns (string memory) {
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 421](../src/jwk/Groth16Verifier.sol#L421)

	```solidity
	    function compressProof(
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 438](../src/jwk/Groth16Verifier.sol#L438)

	```solidity
	    function verifyCompressedProof(uint256[4] calldata compressedProof, uint256[3] calldata input) public view {
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 499](../src/jwk/Groth16Verifier.sol#L499)

	```solidity
	    function verifyProof(uint256[8] calldata proof, uint256[3] calldata input) public view {
	```

- Found in src/stake/StakeConfig.sol [Line: 48](../src/stake/StakeConfig.sol#L48)

	```solidity
	    function initialize() public initializer onlyGenesis {
	```

- Found in src/stake/StakeCredit.sol [Line: 383](../src/stake/StakeCredit.sol#L383)

	```solidity
	    function getSharesByPooledG(
	```

- Found in src/stake/ValidatorManager.sol [Line: 487](../src/stake/ValidatorManager.sol#L487)

	```solidity
	    function getValidatorState(
	```

- Found in src/stake/ValidatorManager.sol [Line: 1184](../src/stake/ValidatorManager.sol#L1184)

	```solidity
	    function isValidator(address validator, address account) public view returns (bool) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 1189](../src/stake/ValidatorManager.sol#L1189)

	```solidity
	    function isOperator(address validator, address account) public view returns (bool) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 1201](../src/stake/ValidatorManager.sol#L1201)

	```solidity
	    function getAllActiveValidatorInfos() public view returns (ValidatorInfo[] memory) {
	```

- Found in src/timestamp/Timestamp.sol [Line: 22](../src/timestamp/Timestamp.sol#L22)

	```solidity
	    function updateGlobalTime(address proposer, uint64 timestamp) public onlyBlock {
	```

</details>



## L-5: Define and use `constant` variables instead of using literals

If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>63 Found Instances</summary>


- Found in src/SystemReward.sol [Line: 68](../src/SystemReward.sol#L68)

	```solidity
	            require(valueLocal.length == 20, "length of value for addAuthorizedCaller should be 20");
	```

- Found in src/SystemReward.sol [Line: 74](../src/SystemReward.sol#L74)

	```solidity
	            require(valueLocal.length == 20, "length of value for deleteAuthorizedCaller should be 20");
	```

- Found in src/epoch/EpochManager.sol [Line: 96](../src/epoch/EpochManager.sol#L96)

	```solidity
	        uint256 epoch_interval_seconds = epochIntervalMicrosecs / 1000000;
	```

- Found in src/epoch/EpochManager.sol [Line: 112](../src/epoch/EpochManager.sol#L112)

	```solidity
	        uint256 epoch_interval_seconds = epochIntervalMicrosecs / 1000000;
	```

- Found in src/governance/GravityGovernor.sol [Line: 138](../src/governance/GravityGovernor.sol#L138)

	```solidity
	            if (value.length != 32) revert InvalidValue(key, value);
	```

- Found in src/governance/GravityGovernor.sol [Line: 143](../src/governance/GravityGovernor.sol#L143)

	```solidity
	            if (value.length != 32) revert InvalidValue(key, value);
	```

- Found in src/governance/GravityGovernor.sol [Line: 148](../src/governance/GravityGovernor.sol#L148)

	```solidity
	            if (value.length != 32) revert InvalidValue(key, value);
	```

- Found in src/governance/GravityGovernor.sol [Line: 153](../src/governance/GravityGovernor.sol#L153)

	```solidity
	            if (value.length != 32) revert InvalidValue(key, value);
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 22](../src/interfaces/IGroth16Verifier.sol#L22)

	```solidity
	        uint256[8] calldata proof
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 23](../src/interfaces/IGroth16Verifier.sol#L23)

	```solidity
	    ) external view returns (uint256[4] memory compressed);
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 32](../src/interfaces/IGroth16Verifier.sol#L32)

	```solidity
	    function verifyCompressedProof(uint256[4] calldata compressedProof, uint256[3] calldata input) external view;
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 41](../src/interfaces/IGroth16Verifier.sol#L41)

	```solidity
	    function verifyProof(uint256[8] calldata proof, uint256[3] calldata input) external view;
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 82](../src/interfaces/IKeylessAccount.sol#L82)

	```solidity
	        uint256[8] calldata proof,
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 85](../src/interfaces/IKeylessAccount.sol#L85)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 96](../src/interfaces/IKeylessAccount.sol#L96)

	```solidity
	        uint256[4] calldata compressedProof,
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 99](../src/interfaces/IKeylessAccount.sol#L99)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 110](../src/interfaces/IKeylessAccount.sol#L110)

	```solidity
	        uint256[8] calldata proof,
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 113](../src/interfaces/IKeylessAccount.sol#L113)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 124](../src/interfaces/IKeylessAccount.sol#L124)

	```solidity
	        uint256[4] calldata compressedProof,
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 127](../src/interfaces/IKeylessAccount.sol#L127)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 209](../src/jwk/Groth16Verifier.sol#L209)

	```solidity
	        uint256 y_pos = sqrt_Fp(addmod(mulmod(mulmod(x, x, P), x, P), 3, P));
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 245](../src/jwk/Groth16Verifier.sol#L245)

	```solidity
	        y = sqrt_Fp(addmod(mulmod(mulmod(x, x, P), x, P), 3, P));
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 283](../src/jwk/Groth16Verifier.sol#L283)

	```solidity
	            uint256 n3ab = mulmod(mulmod(x0, x1, P), P - 3, P);
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 342](../src/jwk/Groth16Verifier.sol#L342)

	```solidity
	        uint256 n3ab = mulmod(mulmod(x0, x1, P), P - 3, P);
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 367](../src/jwk/Groth16Verifier.sol#L367)

	```solidity
	        uint256[3] calldata input
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 422](../src/jwk/Groth16Verifier.sol#L422)

	```solidity
	        uint256[8] calldata proof
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 423](../src/jwk/Groth16Verifier.sol#L423)

	```solidity
	    ) public view returns (uint256[4] memory compressed) {
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 438](../src/jwk/Groth16Verifier.sol#L438)

	```solidity
	    function verifyCompressedProof(uint256[4] calldata compressedProof, uint256[3] calldata input) public view {
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 499](../src/jwk/Groth16Verifier.sol#L499)

	```solidity
	    function verifyProof(uint256[8] calldata proof, uint256[3] calldata input) public view {
	```

- Found in src/jwk/JWKManager.sol [Line: 72](../src/jwk/JWKManager.sol#L72)

	```solidity
	        maxIssValBytes = 256;
	```

- Found in src/jwk/JWKManager.sol [Line: 73](../src/jwk/JWKManager.sol#L73)

	```solidity
	        maxExtraFieldBytes = 256;
	```

- Found in src/jwk/JWKUtils.sol [Line: 222](../src/jwk/JWKUtils.sol#L222)

	```solidity
	        if (nameBytes.length < 8) return false;
	```

- Found in src/jwk/JWKUtils.sol [Line: 224](../src/jwk/JWKUtils.sol#L224)

	```solidity
	        bytes8 httpsPrefix = bytes8(nameBytes[0]) | (bytes8(nameBytes[1]) << 8) | (bytes8(nameBytes[2]) << 16)
	```

- Found in src/jwk/KeylessAccount.sol [Line: 58](../src/jwk/KeylessAccount.sol#L58)

	```solidity
	            max_commited_epk_bytes: 128,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 59](../src/jwk/KeylessAccount.sol#L59)

	```solidity
	            max_iss_val_bytes: 128,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 193](../src/jwk/KeylessAccount.sol#L193)

	```solidity
	        uint256[8] calldata proof,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 196](../src/jwk/KeylessAccount.sol#L196)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/jwk/KeylessAccount.sol [Line: 232](../src/jwk/KeylessAccount.sol#L232)

	```solidity
	        uint256[4] calldata compressedProof,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 235](../src/jwk/KeylessAccount.sol#L235)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/jwk/KeylessAccount.sol [Line: 271](../src/jwk/KeylessAccount.sol#L271)

	```solidity
	        uint256[8] calldata proof,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 274](../src/jwk/KeylessAccount.sol#L274)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/jwk/KeylessAccount.sol [Line: 300](../src/jwk/KeylessAccount.sol#L300)

	```solidity
	        uint256[4] calldata compressedProof,
	```

- Found in src/jwk/KeylessAccount.sol [Line: 303](../src/jwk/KeylessAccount.sol#L303)

	```solidity
	        uint256[3] calldata publicInputs
	```

- Found in src/stake/StakeConfig.sol [Line: 52](../src/stake/StakeConfig.sol#L52)

	```solidity
	        minDelegationStake = 0.1 ether;
	```

- Found in src/stake/StakeConfig.sol [Line: 53](../src/stake/StakeConfig.sol#L53)

	```solidity
	        minDelegationChange = 0.1 ether;
	```

- Found in src/stake/StakeConfig.sol [Line: 54](../src/stake/StakeConfig.sol#L54)

	```solidity
	        maxValidatorCount = 100;
	```

- Found in src/stake/StakeConfig.sol [Line: 60](../src/stake/StakeConfig.sol#L60)

	```solidity
	        rewardsRate = 100; // 1.00%
	```

- Found in src/stake/StakeCredit.sol [Line: 52](../src/stake/StakeCredit.sol#L52)

	```solidity
	        uint256 index = ITimestamp(TIMESTAMP_ADDR).nowSeconds() / 86400; // Daily index
	```

- Found in src/stake/StakeCredit.sol [Line: 336](../src/stake/StakeCredit.sol#L336)

	```solidity
	        uint256 index = ITimestamp(TIMESTAMP_ADDR).nowSeconds() / 86400;
	```

- Found in src/stake/ValidatorManager.sol [Line: 147](../src/stake/ValidatorManager.sol#L147)

	```solidity
	                    maxRate: 5000, // default max commission rate 50%
	```

- Found in src/stake/ValidatorManager.sol [Line: 148](../src/stake/ValidatorManager.sol#L148)

	```solidity
	                    maxChangeRate: 500 // default max daily change rate 5%
	```

- Found in src/stake/ValidatorManager.sol [Line: 963](../src/stake/ValidatorManager.sol#L963)

	```solidity
	                maxRate: 5000, // default max commission rate 50%
	```

- Found in src/stake/ValidatorManager.sol [Line: 964](../src/stake/ValidatorManager.sol#L964)

	```solidity
	                maxChangeRate: 500 // default max daily change rate 5%
	```

- Found in src/stake/ValidatorManager.sol [Line: 1106](../src/stake/ValidatorManager.sol#L1106)

	```solidity
	        if (uint8(bz[0]) < 65 || uint8(bz[0]) > 90) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 1114](../src/stake/ValidatorManager.sol#L1114)

	```solidity
	                (uint8(bz[i]) < 48 || uint8(bz[i]) > 57) && (uint8(bz[i]) < 65 || uint8(bz[i]) > 90)
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 210](../src/stake/ValidatorPerformanceTracker.sol#L210)

	```solidity
	        return (uint256(perf.successfulProposals) * 10000) / uint256(total);
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 241](../src/stake/ValidatorPerformanceTracker.sol#L241)

	```solidity
	            averageSuccessRate = (totalSuccessful * 10000) / grandTotal;
	```

</details>



## L-6: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

<details><summary>62 Found Instances</summary>


- Found in src/System.sol [Line: 43](../src/System.sol#L43)

	```solidity
	    event ParamChange(string key, bytes value);
	```

- Found in src/SystemReward.sol [Line: 29](../src/SystemReward.sol#L29)

	```solidity
	    event rewardTo(address indexed to, uint256 amount);
	```

- Found in src/SystemReward.sol [Line: 31](../src/SystemReward.sol#L31)

	```solidity
	    event receiveDeposit(address indexed from, uint256 amount);
	```

- Found in src/SystemReward.sol [Line: 34](../src/SystemReward.sol#L34)

	```solidity
	    event paramChange(string key, bytes value);
	```

- Found in src/genesis/Genesis.sol [Line: 30](../src/genesis/Genesis.sol#L30)

	```solidity
	    event GenesisCompleted(uint256 timestamp, uint256 validatorCount);
	```

- Found in src/governance/GovHub.sol [Line: 11](../src/governance/GovHub.sol#L11)

	```solidity
	    event failReasonWithStr(string message);
	```

- Found in src/governance/GovHub.sol [Line: 12](../src/governance/GovHub.sol#L12)

	```solidity
	    event failReasonWithBytes(bytes message);
	```

- Found in src/interfaces/IBlock.sol [Line: 12](../src/interfaces/IBlock.sol#L12)

	```solidity
	    event NewBlockEvent(
	```

- Found in src/interfaces/IDelegation.sol [Line: 19](../src/interfaces/IDelegation.sol#L19)

	```solidity
	    event Undelegated(address indexed validator, address indexed delegator, uint256 shares, uint256 amount);
	```

- Found in src/interfaces/IDelegation.sol [Line: 30](../src/interfaces/IDelegation.sol#L30)

	```solidity
	    event Delegated(address indexed delegator, address indexed validator, uint256 amount, uint256 shares);
	```

- Found in src/interfaces/IDelegation.sol [Line: 31](../src/interfaces/IDelegation.sol#L31)

	```solidity
	    event Undelegated(address indexed delegator, address indexed validator, uint256 amount);
	```

- Found in src/interfaces/IDelegation.sol [Line: 35](../src/interfaces/IDelegation.sol#L35)

	```solidity
	    event UnbondedTokensWithdrawn(address indexed delegator, uint256 amount);
	```

- Found in src/interfaces/IDelegation.sol [Line: 36](../src/interfaces/IDelegation.sol#L36)

	```solidity
	    event StakeClaimed(address indexed delegator, address indexed validator, uint256 amount);
	```

- Found in src/interfaces/IEpochManager.sol [Line: 12](../src/interfaces/IEpochManager.sol#L12)

	```solidity
	    event EpochTransitioned(uint256 indexed newEpoch, uint256 transitionTime);
	```

- Found in src/interfaces/IEpochManager.sol [Line: 13](../src/interfaces/IEpochManager.sol#L13)

	```solidity
	    event AllValidatorsUpdated(uint256 indexed newEpoch, IValidatorManager.ValidatorInfo[] validatorInfos);
	```

- Found in src/interfaces/IEpochManager.sol [Line: 14](../src/interfaces/IEpochManager.sol#L14)

	```solidity
	    event EpochDurationUpdated(uint256 oldDuration, uint256 newDuration);
	```

- Found in src/interfaces/IEpochManager.sol [Line: 15](../src/interfaces/IEpochManager.sol#L15)

	```solidity
	    event ModuleNotificationFailed(address indexed module, bytes reason);
	```

- Found in src/interfaces/IEpochManager.sol [Line: 16](../src/interfaces/IEpochManager.sol#L16)

	```solidity
	    event ConfigParamUpdated(string indexed param, uint256 oldValue, uint256 newValue);
	```

- Found in src/interfaces/IGovToken.sol [Line: 93](../src/interfaces/IGovToken.sol#L93)

	```solidity
	    event Transfer(address indexed from, address indexed to, uint256 value);
	```

- Found in src/interfaces/IGovToken.sol [Line: 97](../src/interfaces/IGovToken.sol#L97)

	```solidity
	    event Approval(address indexed owner, address indexed spender, uint256 value);
	```

- Found in src/interfaces/IGovToken.sol [Line: 105](../src/interfaces/IGovToken.sol#L105)

	```solidity
	    event DelegateVotesChanged(address indexed delegate, uint256 previousBalance, uint256 newBalance);
	```

- Found in src/interfaces/IJWKManager.sol [Line: 84](../src/interfaces/IJWKManager.sol#L84)

	```solidity
	    event OIDCProviderAdded(string indexed name, string configUrl);
	```

- Found in src/interfaces/IJWKManager.sol [Line: 86](../src/interfaces/IJWKManager.sol#L86)

	```solidity
	    event OIDCProviderUpdated(string indexed name, string newConfigUrl);
	```

- Found in src/interfaces/IJWKManager.sol [Line: 89](../src/interfaces/IJWKManager.sol#L89)

	```solidity
	    event PatchesUpdated(uint256 patchCount);
	```

- Found in src/interfaces/IJWKManager.sol [Line: 91](../src/interfaces/IJWKManager.sol#L91)

	```solidity
	    event ConfigParamUpdated(string indexed key, uint256 oldValue, uint256 newValue);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 60](../src/interfaces/IKeylessAccount.sol#L60)

	```solidity
	    event KeylessAccountCreated(address indexed account, string indexed issuer, bytes32 jwkHash);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 61](../src/interfaces/IKeylessAccount.sol#L61)

	```solidity
	    event KeylessAccountRecovered(address indexed account, string indexed issuer, bytes32 newJwkHash);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 62](../src/interfaces/IKeylessAccount.sol#L62)

	```solidity
	    event VerifierContractUpdated(address newVerifier);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 63](../src/interfaces/IKeylessAccount.sol#L63)

	```solidity
	    event ConfigurationUpdated(bytes32 configHash);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 64](../src/interfaces/IKeylessAccount.sol#L64)

	```solidity
	    event OverrideAudAdded(string value);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 65](../src/interfaces/IKeylessAccount.sol#L65)

	```solidity
	    event OverrideAudRemoved(string value);
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 66](../src/interfaces/IKeylessAccount.sol#L66)

	```solidity
	    event ConfigParamUpdated(string indexed key, uint256 oldValue, uint256 newValue);
	```

- Found in src/interfaces/IStakeConfig.sol [Line: 21](../src/interfaces/IStakeConfig.sol#L21)

	```solidity
	    event ConfigParamUpdated(string parameter, uint256 oldValue, uint256 newValue);
	```

- Found in src/interfaces/IStakeConfig.sol [Line: 22](../src/interfaces/IStakeConfig.sol#L22)

	```solidity
	    event ConfigBoolParamUpdated(string parameter, bool oldValue, bool newValue);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 28](../src/interfaces/IStakeCredit.sol#L28)

	```solidity
	    event RewardReceived(uint256 rewardToAll, uint256 commission);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 29](../src/interfaces/IStakeCredit.sol#L29)

	```solidity
	    event StakeAdded(address indexed delegator, uint256 shares, uint256 gAmount);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 30](../src/interfaces/IStakeCredit.sol#L30)

	```solidity
	    event StakeUnlocked(address indexed delegator, uint256 shares, uint256 gAmount);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 31](../src/interfaces/IStakeCredit.sol#L31)

	```solidity
	    event StakeWithdrawn(address indexed delegator, uint256 amount);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 32](../src/interfaces/IStakeCredit.sol#L32)

	```solidity
	    event EpochTransitioned(
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 42](../src/interfaces/IStakeCredit.sol#L42)

	```solidity
	    event Initialized(address validator, string moniker, address beneficiary);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 43](../src/interfaces/IStakeCredit.sol#L43)

	```solidity
	    event StakeReactivated(address indexed delegator, uint256 shares, uint256 gAmount);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 45](../src/interfaces/IStakeCredit.sol#L45)

	```solidity
	    event UnlockRequestCreated(uint256 timestamp);
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 46](../src/interfaces/IStakeCredit.sol#L46)

	```solidity
	    event UnlockRequestProcessed(uint256 amount);
	```

- Found in src/interfaces/ITimestamp.sol [Line: 16](../src/interfaces/ITimestamp.sol#L16)

	```solidity
	    event GlobalTimeUpdated(address indexed proposer, uint64 oldTimestamp, uint64 newTimestamp, bool isNilBlock);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 66](../src/interfaces/IValidatorManager.sol#L66)

	```solidity
	    event ValidatorRegistered(
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 70](../src/interfaces/IValidatorManager.sol#L70)

	```solidity
	    event StakeCreditDeployed(address indexed validator, address stakeCreditAddress);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 71](../src/interfaces/IValidatorManager.sol#L71)

	```solidity
	    event ValidatorInfoUpdated(address indexed validator, string field);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 72](../src/interfaces/IValidatorManager.sol#L72)

	```solidity
	    event RewardsCollected(uint256 amount, uint256 totalIncoming);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 73](../src/interfaces/IValidatorManager.sol#L73)

	```solidity
	    event CommissionRateEdited(address indexed operatorAddress, uint64 newCommissionRate);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 79](../src/interfaces/IValidatorManager.sol#L79)

	```solidity
	    event ValidatorJoinRequested(address indexed validator, uint256 votingPower, uint64 epoch);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 80](../src/interfaces/IValidatorManager.sol#L80)

	```solidity
	    event ValidatorLeaveRequested(address indexed validator, uint64 epoch);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 81](../src/interfaces/IValidatorManager.sol#L81)

	```solidity
	    event ValidatorStatusChanged(address indexed validator, uint8 oldStatus, uint8 newStatus, uint64 epoch);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 84](../src/interfaces/IValidatorManager.sol#L84)

	```solidity
	    event RewardsDistributed(address indexed validator, uint256 amount);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 85](../src/interfaces/IValidatorManager.sol#L85)

	```solidity
	    event RewardDistributeFailed(address indexed validator, string reason);
	```

- Found in src/interfaces/IValidatorManager.sol [Line: 88](../src/interfaces/IValidatorManager.sol#L88)

	```solidity
	    event ValidatorSetUpdated(
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 16](../src/interfaces/IValidatorPerformanceTracker.sol#L16)

	```solidity
	    event PerformanceUpdated(
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 25](../src/interfaces/IValidatorPerformanceTracker.sol#L25)

	```solidity
	    event ProposalResult(address indexed validator, uint256 indexed validatorIndex, bool success, uint256 epoch);
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 28](../src/interfaces/IValidatorPerformanceTracker.sol#L28)

	```solidity
	    event EpochPerformanceFinalized(
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 33](../src/interfaces/IValidatorPerformanceTracker.sol#L33)

	```solidity
	    event ActiveValidatorSetUpdated(uint256 indexed epoch, address[] validators);
	```

- Found in src/interfaces/IValidatorPerformanceTracker.sol [Line: 36](../src/interfaces/IValidatorPerformanceTracker.sol#L36)

	```solidity
	    event PerformanceReset(uint256 indexed newEpoch, uint256 validatorCount);
	```

- Found in src/jwk/JWKUtils.sol [Line: 305](../src/jwk/JWKUtils.sol#L305)

	```solidity
	    event JWKCreated(bytes32 indexed jwkHash, uint8 variant, bytes data);
	```

- Found in src/jwk/JWKUtils.sol [Line: 306](../src/jwk/JWKUtils.sol#L306)

	```solidity
	    event PatchCreated(bytes32 indexed patchHash, IJWKManager.PatchType patchType);
	```

</details>



## L-7: The `nonReentrant` `modifier` should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers.

<details><summary>2 Found Instances</summary>


- Found in src/stake/Delegation.sol [Line: 150](../src/stake/Delegation.sol#L150)

	```solidity
	    ) external whenNotPaused notInBlackList validatorExists(srcValidator) validatorExists(dstValidator) nonReentrant {
	```

- Found in src/stake/StakeCredit.sol [Line: 199](../src/stake/StakeCredit.sol#L199)

	```solidity
	    ) external onlyDelegationOrValidatorManager nonReentrant returns (uint256 amount) {
	```

</details>



## L-8: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>3 Found Instances</summary>


- Found in src/interfaces/IGovToken.sol [Line: 2](../src/interfaces/IGovToken.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IGroth16Verifier.sol [Line: 2](../src/interfaces/IGroth16Verifier.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 3](../src/jwk/Groth16Verifier.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-9: Modifiers invoked only once can be shoe-horned into the function



<details><summary>9 Found Instances</summary>


- Found in src/System.sol [Line: 61](../src/System.sol#L61)

	```solidity
	    modifier onlyEpochManager() {
	```

- Found in src/System.sol [Line: 103](../src/System.sol#L103)

	```solidity
	    modifier onlyGovernorTimelock() {
	```

- Found in src/SystemReward.sol [Line: 15](../src/SystemReward.sol#L15)

	```solidity
	    modifier doInit() {
	```

- Found in src/SystemReward.sol [Line: 24](../src/SystemReward.sol#L24)

	```solidity
	    modifier onlyAuthorizedCaller() {
	```

- Found in src/access/Protectable.sol [Line: 30](../src/access/Protectable.sol#L30)

	```solidity
	    modifier whenPaused() {
	```

- Found in src/epoch/EpochManager.sol [Line: 29](../src/epoch/EpochManager.sol#L29)

	```solidity
	    modifier onlyAuthorizedCallers() {
	```

- Found in src/stake/ValidatorManager.sol [Line: 76](../src/stake/ValidatorManager.sol#L76)

	```solidity
	    modifier onlyValidatorSelf(
	```

- Found in src/stake/ValidatorManager.sol [Line: 85](../src/stake/ValidatorManager.sol#L85)

	```solidity
	    modifier validAddress(
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 29](../src/stake/ValidatorPerformanceTracker.sol#L29)

	```solidity
	    modifier validValidatorIndex(
	```

</details>



## L-10: Empty Block

Consider removing empty blocks.

<details><summary>1 Found Instances</summary>


- Found in src/stake/StakeCredit.sol [Line: 536](../src/stake/StakeCredit.sol#L536)

	```solidity
	    function processUserUnlocks(
	```

</details>



## L-11: Large literal values multiples of 10000 can be replaced with scientific notation

Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>15 Found Instances</summary>


- Found in src/SystemReward.sol [Line: 10](../src/SystemReward.sol#L10)

	```solidity
	    uint256 public constant MAX_REWARDS = 10000 ether;
	```

- Found in src/epoch/EpochManager.sol [Line: 47](../src/epoch/EpochManager.sol#L47)

	```solidity
	        epochIntervalMicrosecs = 2 hours * 1_000_000;
	```

- Found in src/epoch/EpochManager.sol [Line: 96](../src/epoch/EpochManager.sol#L96)

	```solidity
	        uint256 epoch_interval_seconds = epochIntervalMicrosecs / 1000000;
	```

- Found in src/epoch/EpochManager.sol [Line: 112](../src/epoch/EpochManager.sol#L112)

	```solidity
	        uint256 epoch_interval_seconds = epochIntervalMicrosecs / 1000000;
	```

- Found in src/governance/GravityGovernor.sol [Line: 43](../src/governance/GravityGovernor.sol#L43)

	```solidity
	    uint256 private constant INIT_PROPOSAL_THRESHOLD = 2_000_000 ether; //  = 2_000_000 G
	```

- Found in src/governance/GravityGovernor.sol [Line: 47](../src/governance/GravityGovernor.sol#L47)

	```solidity
	    uint256 private constant PROPOSE_START_GOVG_SUPPLY_THRESHOLD = 1_000_000_000 ether;
	```

- Found in src/governance/GravityGovernor.sol [Line: 150](../src/governance/GravityGovernor.sol#L150)

	```solidity
	            if (newProposalThreshold == 0 || newProposalThreshold > 10_000 ether) revert InvalidValue(key, value);
	```

- Found in src/stake/StakeConfig.sol [Line: 16](../src/stake/StakeConfig.sol#L16)

	```solidity
	    uint256 public constant PERCENTAGE_BASE = 10000; // 100.00%
	```

- Found in src/stake/StakeConfig.sol [Line: 17](../src/stake/StakeConfig.sol#L17)

	```solidity
	    uint256 public constant MAX_REWARDS_RATE = 1000000;
	```

- Found in src/stake/StakeConfig.sol [Line: 51](../src/stake/StakeConfig.sol#L51)

	```solidity
	        maximumStake = 1000000 ether;
	```

- Found in src/stake/StakeConfig.sol [Line: 71](../src/stake/StakeConfig.sol#L71)

	```solidity
	        lockAmount = 10000 ether;
	```

- Found in src/stake/StakeCredit.sol [Line: 21](../src/stake/StakeCredit.sol#L21)

	```solidity
	    uint256 private constant COMMISSION_RATE_BASE = 10_000; // 100%
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 210](../src/stake/ValidatorPerformanceTracker.sol#L210)

	```solidity
	        return (uint256(perf.successfulProposals) * 10000) / uint256(total);
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 241](../src/stake/ValidatorPerformanceTracker.sol#L241)

	```solidity
	            averageSuccessRate = (totalSuccessful * 10000) / grandTotal;
	```

- Found in src/timestamp/Timestamp.sol [Line: 13](../src/timestamp/Timestamp.sol#L13)

	```solidity
	    uint64 public constant MICRO_CONVERSION_FACTOR = 1_000_000;
	```

</details>



## L-12: Internal functions called only once can be inlined

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>5 Found Instances</summary>


- Found in src/governance/GovHub.sol [Line: 25](../src/governance/GovHub.sol#L25)

	```solidity
	    function notifyUpdates(
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 121](../src/jwk/Groth16Verifier.sol#L121)

	```solidity
	    function invert_Fp(
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 155](../src/jwk/Groth16Verifier.sol#L155)

	```solidity
	    function isSquare_Fp(
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 263](../src/jwk/Groth16Verifier.sol#L263)

	```solidity
	    function compress_g2(
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 323](../src/jwk/Groth16Verifier.sol#L323)

	```solidity
	    function decompress_g2(
	```

</details>



## L-13: Unused Custom Error

it is recommended that the definition be removed when custom error is unused

<details><summary>17 Found Instances</summary>


- Found in src/System.sol [Line: 36](../src/System.sol#L36)

	```solidity
	    error OnlyCoinbase();
	```

- Found in src/System.sol [Line: 38](../src/System.sol#L38)

	```solidity
	    error OnlyZeroGasPrice();
	```

- Found in src/interfaces/IGovToken.sol [Line: 115](../src/interfaces/IGovToken.sol#L115)

	```solidity
	    error ERC20InsufficientBalance(address sender, uint256 balance, uint256 needed);
	```

- Found in src/interfaces/IGovToken.sol [Line: 118](../src/interfaces/IGovToken.sol#L118)

	```solidity
	    error ERC20InvalidSender(address sender);
	```

- Found in src/interfaces/IGovToken.sol [Line: 121](../src/interfaces/IGovToken.sol#L121)

	```solidity
	    error ERC20InvalidReceiver(address receiver);
	```

- Found in src/interfaces/IGovToken.sol [Line: 124](../src/interfaces/IGovToken.sol#L124)

	```solidity
	    error ERC20InsufficientAllowance(address spender, uint256 allowance, uint256 needed);
	```

- Found in src/interfaces/IGovToken.sol [Line: 127](../src/interfaces/IGovToken.sol#L127)

	```solidity
	    error ERC20InvalidApprover(address approver);
	```

- Found in src/interfaces/IGovToken.sol [Line: 130](../src/interfaces/IGovToken.sol#L130)

	```solidity
	    error ERC20InvalidSpender(address spender);
	```

- Found in src/interfaces/IJWKManager.sol [Line: 15](../src/interfaces/IJWKManager.sol#L15)

	```solidity
	    error DuplicateProvider();
	```

- Found in src/interfaces/IJWKManager.sol [Line: 22](../src/interfaces/IJWKManager.sol#L22)

	```solidity
	    error NotAuthorized();
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 16](../src/interfaces/IKeylessAccount.sol#L16)

	```solidity
	    error InvalidSignature();
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 19](../src/interfaces/IKeylessAccount.sol#L19)

	```solidity
	    error JWTVerificationFailed();
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 20](../src/interfaces/IKeylessAccount.sol#L20)

	```solidity
	    error ExceededMaxSignaturesPerTxn();
	```

- Found in src/interfaces/IKeylessAccount.sol [Line: 21](../src/interfaces/IKeylessAccount.sol#L21)

	```solidity
	    error ExceededMaxExpHorizon();
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 23](../src/interfaces/IStakeCredit.sol#L23)

	```solidity
	    error StakeCredit__RequestExists();
	```

- Found in src/interfaces/IStakeCredit.sol [Line: 24](../src/interfaces/IStakeCredit.sol#L24)

	```solidity
	    error StakeCredit__NoUnlockRequest();
	```

- Found in src/jwk/JWKUtils.sol [Line: 15](../src/jwk/JWKUtils.sol#L15)

	```solidity
	    error InvalidRSAJWK();
	```

</details>



## L-14: Loop contains `require`/`revert` statements

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>1 Found Instances</summary>


- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 332](../src/stake/ValidatorPerformanceTracker.sol#L332)

	```solidity
	        for (uint256 i = 0; i < validators.length; i++) {
	```

</details>



## L-15: Potentially unused `private` / `internal` state variables found.

State variable appears to be unused. No analysis has been performed to see if any inilne assembly references it. So if that's not the case, consider removing this unused variable.

<details><summary>14 Found Instances</summary>


- Found in src/jwk/Groth16Verifier.sol [Line: 15](../src/jwk/Groth16Verifier.sol#L15)

	```solidity
	    uint256 constant PRECOMPILE_MODEXP = 0x05;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 16](../src/jwk/Groth16Verifier.sol#L16)

	```solidity
	    uint256 constant PRECOMPILE_ADD = 0x06;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 17](../src/jwk/Groth16Verifier.sol#L17)

	```solidity
	    uint256 constant PRECOMPILE_MUL = 0x07;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 18](../src/jwk/Groth16Verifier.sol#L18)

	```solidity
	    uint256 constant PRECOMPILE_VERIFY = 0x08;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 26](../src/jwk/Groth16Verifier.sol#L26)

	```solidity
	    uint256 constant R = 0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 67](../src/jwk/Groth16Verifier.sol#L67)

	```solidity
	    uint256 constant CONSTANT_X = 15295233055465821501991355059786655929345084264410368481848696592381276332447;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 68](../src/jwk/Groth16Verifier.sol#L68)

	```solidity
	    uint256 constant CONSTANT_Y = 141548282483489768856266604006904606066783280663495077679615269067118297196;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 69](../src/jwk/Groth16Verifier.sol#L69)

	```solidity
	    uint256 constant PUB_0_X = 5833464327257661380125992672199683795323108649747723589664117945111874692514;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 70](../src/jwk/Groth16Verifier.sol#L70)

	```solidity
	    uint256 constant PUB_0_Y = 15225794791849229830322593539558778436788842050836062215448120168486818026405;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 71](../src/jwk/Groth16Verifier.sol#L71)

	```solidity
	    uint256 constant PUB_1_X = 3793152279874321668520061702794574098713903789544217830920436799322645978930;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 72](../src/jwk/Groth16Verifier.sol#L72)

	```solidity
	    uint256 constant PUB_1_Y = 11486554486164543269534974177749017872678325217321658778051756338081698879522;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 73](../src/jwk/Groth16Verifier.sol#L73)

	```solidity
	    uint256 constant PUB_2_X = 12362881454066905509965037072888018584217251308580686713487932946646627642012;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 74](../src/jwk/Groth16Verifier.sol#L74)

	```solidity
	    uint256 constant PUB_2_Y = 6220649044343669094111973470687378214943185784157079100414679000128980854516;
	```

- Found in src/jwk/Groth16Verifier.sol [Line: 546](../src/jwk/Groth16Verifier.sol#L546)

	```solidity
	    bytes32 constant CIRCUIT_DIGEST = 0x25ec6f0dccc36e6bf106457c080711354848c1a4f991c9b9989be13fd411a368;
	```

</details>



## L-16: Uninitialized local variables.

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>1 Found Instances</summary>


- Found in src/jwk/Groth16Verifier.sol [Line: 479](../src/jwk/Groth16Verifier.sol#L479)

	```solidity
	        uint256[1] memory output;
	```

</details>



## L-17: Dead Code

Functions that are not used. Consider removing them.

<details><summary>1 Found Instances</summary>


- Found in src/stake/ValidatorManager.sol [Line: 947](../src/stake/ValidatorManager.sol#L947)

	```solidity
	    function _storeValidatorInfo(
	```

</details>



## L-18: Loop condition contains `state_variable.length` that could be cached outside.

Cache the lengths of storage arrays if they are used and not modified in for loops.

<details><summary>6 Found Instances</summary>


- Found in src/jwk/JWKManager.sol [Line: 153](../src/jwk/JWKManager.sol#L153)

	```solidity
	        for (uint256 i = 0; i < supportedProviders.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 161](../src/jwk/JWKManager.sol#L161)

	```solidity
	        for (uint256 i = 0; i < supportedProviders.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 187](../src/stake/ValidatorPerformanceTracker.sol#L187)

	```solidity
	        for (uint256 i = 0; i < currentValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 224](../src/stake/ValidatorPerformanceTracker.sol#L224)

	```solidity
	            for (uint256 i = 0; i < currentValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 283](../src/stake/ValidatorPerformanceTracker.sol#L283)

	```solidity
	            for (uint256 i = 0; i < currentValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 322](../src/stake/ValidatorPerformanceTracker.sol#L322)

	```solidity
	        for (uint256 i = 0; i < activeValidators.length; i++) {
	```

</details>



## L-19: Costly operations inside loops.

Invoking `SSTORE`operations in loops may lead to Out-of-gas errors. Use a local variable to hold the loop computation result.

<details><summary>34 Found Instances</summary>


- Found in src/governance/GovToken.sol [Line: 55](../src/governance/GovToken.sol#L55)

	```solidity
	        for (uint256 i = 0; i < _length; ++i) {
	```

- Found in src/jwk/JWKManager.sol [Line: 177](../src/jwk/JWKManager.sol#L177)

	```solidity
	        for (uint256 i = 0; i < providerJWKsArray.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 203](../src/jwk/JWKManager.sol#L203)

	```solidity
	        for (uint256 i = 0; i < newPatches.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 278](../src/jwk/JWKManager.sol#L278)

	```solidity
	        for (uint256 i = 0; i < patchArray.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 351](../src/jwk/JWKManager.sol#L351)

	```solidity
	        for (uint256 i = 0; i < patches.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 366](../src/jwk/JWKManager.sol#L366)

	```solidity
	        for (uint256 i = 0; i < src.entries.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 376](../src/jwk/JWKManager.sol#L376)

	```solidity
	            for (uint256 j = 0; j < srcEntry.jwks.length; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 404](../src/jwk/JWKManager.sol#L404)

	```solidity
	        for (uint256 i = 0; i < jwks.entries.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 412](../src/jwk/JWKManager.sol#L412)

	```solidity
	                for (uint256 j = 0; j < providerJWKs.jwks.length; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 431](../src/jwk/JWKManager.sol#L431)

	```solidity
	        for (uint256 i = jwks.entries.length - 1; i > insertIndex; i--) {
	```

- Found in src/jwk/JWKManager.sol [Line: 436](../src/jwk/JWKManager.sol#L436)

	```solidity
	            for (uint256 j = 0; j < jwks.entries[i - 1].jwks.length; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 445](../src/jwk/JWKManager.sol#L445)

	```solidity
	        for (uint256 j = 0; j < providerJWKs.jwks.length; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 454](../src/jwk/JWKManager.sol#L454)

	```solidity
	        for (uint256 i = 0; i < jwks.entries.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 457](../src/jwk/JWKManager.sol#L457)

	```solidity
	                for (uint256 j = i; j < jwks.entries.length - 1; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 462](../src/jwk/JWKManager.sol#L462)

	```solidity
	                    for (uint256 k = 0; k < jwks.entries[j + 1].jwks.length; k++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 497](../src/jwk/JWKManager.sol#L497)

	```solidity
	            for (uint256 i = 0; i < provider.jwks.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 527](../src/jwk/JWKManager.sol#L527)

	```solidity
	                for (uint256 i = 0; i < newJWKs.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 538](../src/jwk/JWKManager.sol#L538)

	```solidity
	        for (uint256 i = 0; i < jwks.entries.length; i++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 541](../src/jwk/JWKManager.sol#L541)

	```solidity
	                for (uint256 j = 0; j < provider.jwks.length; j++) {
	```

- Found in src/jwk/JWKManager.sol [Line: 544](../src/jwk/JWKManager.sol#L544)

	```solidity
	                        for (uint256 k = j; k < provider.jwks.length - 1; k++) {
	```

- Found in src/jwk/KeylessAccount.sol [Line: 158](../src/jwk/KeylessAccount.sol#L158)

	```solidity
	            for (uint256 i = 0; i < length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 131](../src/stake/ValidatorManager.sol#L131)

	```solidity
	        for (uint256 i = 0; i < validatorAddresses.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 633](../src/stake/ValidatorManager.sol#L633)

	```solidity
	        for (uint256 i = 0; i < pendingValidators.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 664](../src/stake/ValidatorManager.sol#L664)

	```solidity
	        for (uint256 i = 0; i < pendingInactiveValidators.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 691](../src/stake/ValidatorManager.sol#L691)

	```solidity
	        for (uint256 i = 0; i < currentActive.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 819](../src/stake/ValidatorManager.sol#L819)

	```solidity
	        for (uint256 i = 0; i < activeVals.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 829](../src/stake/ValidatorManager.sol#L829)

	```solidity
	        for (uint256 i = 0; i < pendingActiveVals.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 839](../src/stake/ValidatorManager.sol#L839)

	```solidity
	        for (uint256 i = 0; i < pendingInactiveVals.length; i++) {
	```

- Found in src/stake/ValidatorManager.sol [Line: 1039](../src/stake/ValidatorManager.sol#L1039)

	```solidity
	            for (uint256 i = 0; i < validators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 82](../src/stake/ValidatorPerformanceTracker.sol#L82)

	```solidity
	        for (uint256 i = 0; i < failedProposerIndices.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 283](../src/stake/ValidatorPerformanceTracker.sol#L283)

	```solidity
	            for (uint256 i = 0; i < currentValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 297](../src/stake/ValidatorPerformanceTracker.sol#L297)

	```solidity
	        for (uint256 i = 0; i < currentValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 322](../src/stake/ValidatorPerformanceTracker.sol#L322)

	```solidity
	        for (uint256 i = 0; i < activeValidators.length; i++) {
	```

- Found in src/stake/ValidatorPerformanceTracker.sol [Line: 332](../src/stake/ValidatorPerformanceTracker.sol#L332)

	```solidity
	        for (uint256 i = 0; i < validators.length; i++) {
	```

</details>



## L-20: Unused Imports

Redundant import statement. Consider removing it.

<details><summary>5 Found Instances</summary>


- Found in src/genesis/Genesis.sol [Line: 8](../src/genesis/Genesis.sol#L8)

	```solidity
	import "@src/interfaces/ITimestamp.sol";
	```

- Found in src/jwk/KeylessAccount.sol [Line: 6](../src/jwk/KeylessAccount.sol#L6)

	```solidity
	import "@src/interfaces/IParamSubscriber.sol";
	```

- Found in src/jwk/KeylessAccount.sol [Line: 7](../src/jwk/KeylessAccount.sol#L7)

	```solidity
	import "@src/interfaces/IReconfigurableModule.sol";
	```

- Found in src/stake/Delegation.sol [Line: 12](../src/stake/Delegation.sol#L12)

	```solidity
	import "@src/interfaces/IReconfigurableModule.sol";
	```

- Found in src/stake/ValidatorManager.sol [Line: 18](../src/stake/ValidatorManager.sol#L18)

	```solidity
	import "@src/interfaces/IReconfigurableModule.sol";
	```

</details>



